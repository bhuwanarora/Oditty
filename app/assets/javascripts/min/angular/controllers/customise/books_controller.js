homeApp.controller("booksController",["$scope","$rootScope","$timeout","bookService","ColorConstants","$mdToast",function(a,b,c,d,e,f){a.books_on_signup=function(){var b=angular.isDefined(a.search_tag)&&angular.isDefined(a.search_tag.book)&&""!=a.search_tag.book&&null!=a.search_tag.book;if(!b){a.info.loading=!0;var c=a.popular_books.length,f=!a._loading&&(angular.isUndefined(a.info.search_book)||a.info.search_book.length<1);if(f){a._loading=!0;var g={skip_count:c};g=angular.toJson(g),d.books_on_signup(g).then(function(b){angular.forEach(b,function(a){var b=Math.floor(Math.random()*e.value.length),c="HaveLeftAMarkOnMe"==a.shelf,d=angular.extend(a,{status:c,color:e.value[b]});this.push(d)},a.popular_books),a._loading=!1,a.info.loading=!1})}else angular.isUndefined(a.all_results_found)||!a.all_results_found,a.info.loading=!1}},a.rate_book=function(a){d.rate_book(a.book_id,a.user_rating)},a.mark_as_read=function(b,c){angular.isDefined(b.id)&&(sharedService.bookmark_book(a,b,c,RecommendationUIConstants.InfluentialBooks),sharedService.mark_as_read(a,b,c))},a.select_book=function(b){angular.forEach(a.popular_books,function(a){if(angular.equals(a,b)){angular.equals(b.status,!1)?b.status=!0:b.status=!1;var c=b.book_id||b.id;d.handle_influential_books(c,b.status)}}),f.show({controller:"toastController",templateUrl:"assets/angular/html/shared/toast/select_book.html",hideDelay:6e3,position:a.getToastPosition()})},a.getToastPosition=function(){return Object.keys(a.toast_position).filter(function(b){return a.toast_position[b]}).join(" ")},a.reset_books=function(){},a.search_books=function(b){a.info.loading=!0,a.popular_books=[],d.search_books(b,10).then(function(b){a.info.loading=!1,a.did_you_mean=!0,angular.forEach(b,function(a){angular.isUndefined(a.fuzzy)&&this.push(a)},a.popular_books)})},a.edit_books_read=function(){a.goto_info_card(),b.user.profile_status=2,a.books_on_signup()};(function(){angular.isUndefined(a.popular_books)&&(a.popular_books=[]),a.toast_position={bottom:!1,top:!0,left:!1,right:!0};var b=c(function(){a.books_on_signup()},100);a.$on("destroy",function(){c.cancel(b)})})()}]);