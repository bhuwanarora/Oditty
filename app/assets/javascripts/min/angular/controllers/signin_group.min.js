homeApp.service("websiteService",["$http","$q","$rootScope","WebsiteUIConstants",function(a,b,c,d){this.get_testimonials=function(c){return _deferred_request("/api/v0/get_testimonials?skip="+c,b,a)},this.add_testimonial=function(c){return _deferred_request("/api/v0/add_testimonial?data="+c,b,a)},this.save_ad=function(c){return _deferred_post_request("/api/v0/save_ad",c,b,a)},this.recover_password=function(c){return _deferred_request("/api/v0/recover_password?"+c,b,a)},this.add_video=function(c,d){return _deferred_request("/api/v0/add_video?id="+c+"&url="+d,b,a)},this.add_videos=function(c){return _deferred_request("/api/v0/add_videos?id="+c,b,a)},this.fb_books_map=function(c){return _deferred_request("/api/v0/fb_books_map?id="+c,b,a)},this.handle_facebook_books=function(c){return _deferred_post_request("/api/v0/fb_books",c,b,a)},this.get_user=function(){return _deferred_request("/api/v0/user",b,a)},this.logout=function(){return _deferred_request("/api/v0/logout",b,a)},this.save_user_info=function(c){return _deferred_post_request("/api/v0/save_info",c,b,a)},this.handle_facebook_user=function(c){return _deferred_post_request("/api/v0/fb",c,b,a)},this.handle_facebook_likes=function(c){return _deferred_post_request("/api/v0/fb_likes",c,b,a)},this.handle_google_user=function(c){return _deferred_post_request("/api/v0/google",c,b,a)},this.authenticate=function(c){return _deferred_post_request("/api/v0/authenticate",c,b,a)},this.get_user_details=function(c){return angular.isDefined(c)?_deferred_request("/api/v0/user_details?id="+c,b,a):_deferred_request("/api/v0/user_details",b,a)},this.get_personal_notifications=function(){return _deferred_request("/api/v0/personal_notifications",b,a)},this.set_like_info=function(c){return _deferred_post_request("/api/v0/set_like_info",c,b,a)},this.get_community_videos=function(c){return _deferred_request("/api/v0/get_community_videos?id="+c,b,a)}}]);;homeApp.controller("signupController",["$scope","$rootScope","Facebook","$timeout","$cookieStore","LoginConstants","WebsiteUIConstants","$location","$routeParams","websiteService","$mdSidenav",function(a,b,c,d,e,f,g,h,i,j,k){a.processAuth=function(b){b.access_token?a.signedIn=!0:"immediate_failed"==b.error&&(gapi.auth.authorize({client_id:"917672049716-pl6i0qbuen1so84tg2b5vijg7qfjhash.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/plus.login email",immediate:!0},function(a){a.status.signed_in}),a.signedIn=!1)},a.close_signup_options=function(){k("signup").toggle()},a.signInCallback=function(b){a.$apply(function(){a.processAuth(b)})},a.renderSignInButton=function(){gapi.signin.render("signInButton",{callback:a.signInCallback,clientid:"917672049716-pl6i0qbuen1so84tg2b5vijg7qfjhash.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/plus.login https://www.googleapis.com/auth/userinfo.email",cookiepolicy:"single_host_origin"})},a.submit=function(b){var c=b.keyCode==g.Enter;c&&a.authenticate(!0),b.stopPropagation()},a.recover_password=function(){var c=function(c){a.loading_icon=!1,a.user.error_message=c.message,b.user.password=null},d=function(c){a.$apply(function(){a.loading_icon=!1,a.user.error_message=c.message,b.user.password=null})};b.user.email?(a.loading_icon=!0,j.recover_password("email="+b.user.email).then(c,d)):a.user.error_message=f.EmailNotPresent},a.authenticate=function(c){c?a.show_sign_up=!1:a.show_sign_up=!0;var d=b.user.email,g=b.user.password,h=new RegExp("^.{8,}$"),i=new RegExp("^(.)\\1{7,16}$"),k=new RegExp("^.{100,}$"),l={email:d,password:g,old_user:c},n=function(c){b.user=c.user,e.put("user",c.user),a._init_user(),m(),a.info.hide_signin=!0},o=function(c){a.loading_icon=!1,a.user.error_message=c.data.message,b.user.password=null};b.user.email?b.user.password?h.test(b.user.password)||c?i.test(b.user.password)&&!c?a.user.error_message=f.ChooseAMoreSecurePassword:k.test(b.user.password)&&!c?a.user.error_message=f.MaximumPasswordLengthError:(a.loading_icon=!0,j.authenticate(l).then(n,o)):a.user.error_message=f.PasswordLengthError:a.user.error_message=f.PasswordNotPresent:a.user.error_message=f.EmailNotPresent};var l=function(){a.$on("event:google-plus-signin-success",function(b,c){j.handle_google_user(c),a._init_user()}),a.$on("event:google-plus-signin-failure",function(a,b){})};a.intent_login=function(){a.loading_icon=!0,b.user.fb_connect?(b.logged=!0,a.me()):a.login()},a.login=function(){c.login(function(b){b.status==f.FacebookLoginStatusCheck&&a.me()},{scope:"email"})},a.me=function(){deleteCookie("redirect_url"),setCookie("redirect_url",h.$$absUrl),c.api("/me",function(c){angular.isUndefined(b.user)&&(b.user={}),j.handle_facebook_user(c).then(function(c){b.user=angular.extend(b.user,c),a._init_user(),m()}),b.user=angular.extend(b.user,c)})};var m=function(){var a=getCookie("redirect_url");1==b.user.login_count?a="/customise":(!a||a.indexOf("signup")>0)&&(a="/home"),window.location.href=a};a._init_user=function(){b.user.logged=!0,setCookie("logged",!0,31),setCookie("logged",b.user.id,31)},a._is_logged_in=function(){var c=function(){j.get_personal_notifications().then(function(a){b.user.push_notifications=[],angular.forEach(a,function(a){var b=angular.extend({id:a[1]},a[0].data);this.push(b)},b.user.push_notifications)})};j.get_user().then(function(d){d.logged_in&&(b.user.logged=!0,b.user.id=d.id,j.get_user_details().then(function(a){angular.extend(b.user,a)}),a._init_user(),c())})};(function(){l(),b.user={books:{bookmarked:[],read:[]},authors:{bookmarked:[],follow:[]},readers:{follow:[]},logged:!1},b.user.fb_connect=!1,c.getLoginStatus(function(a){a.status===f.FacebookLoginStatusCheck&&(b.user.fb_connect=!0)});var e=0,g=500,h=function(b){a.description=[],a.description.splice(0,0,f.Description[b])};angular.forEach(f.Description,function(){0==e?(h(e),e+=1):d(function(){h(e),e+=1},g),g+=1500})})()}]);