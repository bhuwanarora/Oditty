function easeInQuad(a){return.5>a?2*a*a:-1+(4-2*a)*a}function setCookie(a,b,c){var d=new Date;d.setTime(d.getTime()+24*c*60*60*1e3);var e="expires="+d.toUTCString();document.cookie=a+"="+b+"; "+e+"; path=/"}function getCookie(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return""}function deleteCookie(a){setCookie(a,"",-1)}var app=angular.module("myApp",["ngAnimate","ngMaterial","duScroll","ngRoute","monospaced.mousewheel","appConstants","timer","facebook","ngCookies"]);app.value("duScrollEasing",easeInQuad),app.config(["$routeProvider",function(a){a.when("/discover",{templateUrl:"assets/angular/html/landing_page/discover.html"}).when("/intro",{templateUrl:"assets/angular/html/landing_page/intro.html"}).when("/connect",{templateUrl:"assets/angular/html/landing_page/connect.html"}).when("/explore",{templateUrl:"assets/angular/html/landing_page/explore.html"}).when("/personalise",{templateUrl:"assets/angular/html/landing_page/personalise.html"}).when("/request",{templateUrl:"assets/angular/html/landing_page/sign_in.html"}).when("/main",{templateUrl:"assets/angular/html/landing_page/main.html"}).otherwise({templateUrl:"assets/angular/html/landing_page/main.html"})}]),app.constant("facebookAppId","667868653261167"),app.config(["FacebookProvider","facebookAppId",function(a,b){var c=b;a.init(c)}]);var _deferred_request=function(a,b,c){var d=b.defer(),e=function(a){return d.resolve(a.data)},f=function(a){500==a.status&&alert("Something went wrong. Our developers are working on this error.")};return c.get(a).then(e,f),d.promise},_deferred_post_request=function(a,b,c,d){var e=c.defer(),f=function(a){return e.resolve(a.data)},g=function(a){if(500==a.status)alert("Something went wrong. Our developers are working on this error.");else if(403==a.status)return e.reject(a)};return d.post(a,b).then(f,g),e.promise};;var appConstants=angular.module("appConstants",[]),emotions=[{name:"nostalgic",icon:"i-nostalgic",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"enlightened",icon:"i-enlightened",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"insane",icon:"i-insane",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"happy",icon:"i-happy",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"sad",icon:"i-sad",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"frustrated",icon:"i-frustrated",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"bored",icon:"i-bored",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"scared",icon:"i-scared",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"funny",icon:"i-funny",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"confused",icon:"i-confused",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"romantic",icon:"i-romantic",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"inspired",icon:"i-inspired",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"out of the world",icon:"i-out-of-the-world",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"alone",icon:"i-alone",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"loved",icon:"i-loved",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"upset",icon:"i-upset",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"awesome",icon:"i-awesome",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"sleepy",icon:"i-sleepy",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"crazy",icon:"i-crazy",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"heartbroken",icon:"i-heartbroken",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"irritated",icon:"i-irritated",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"wonderful",icon:"i-wonderful",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"blessed",icon:"i-blessed",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"lonely",icon:"i-lonely",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"incomplete",icon:"i-incomplete",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"hopeful",icon:"i-hopeful",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"hurt",icon:"i-hurt",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"great",icon:"i-great",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"high",icon:"i-high",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"pumped",icon:"i-pumped",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"drained",icon:"i-drained",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"old",icon:"i-old",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"naughty",icon:"i-naughty",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"guilty",icon:"i-guilty",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"low",icon:"i-low",value:[{SearchBook:!0}],icon2:"icon-book",link:"while reading"},{name:"excited",icon:"i-excited",value:[{SearchBook:!0}],icon2:"icon-book"}],places=[],constants={Times:[{name:"Contemporary",range:"2000-2014",id:422374},{name:"Post Modern",range:"1939-2000",id:422373},{name:"Modern",range:"1901-1939",id:422372},{name:"Victorian",range:"1837-1901",id:422371},{name:"Romantic",range:"1798-1837",id:422370},{name:"Neo Classical",range:"1660-1798",id:422367},{name:"English Renaissance",range:"1500-1660",id:422366},{name:"Middle English",range:"1100-1500",id:422362},{name:"Old English",range:"658-1100",id:422359}],PopularGenres:[{books_count:"93815",name:"History",id:384361},{books_count:"42112",name:"Horror",id:384362},{books_count:"70679",name:"Humor",id:384364},{books_count:"26218",name:"Love",id:384372},{books_count:"9231",name:"Leadership",id:384369},{books_count:"17534",name:"Mythology",id:384380},{books_count:"65102",name:"Poetry",id:384389},{books_count:"52400",name:"Politics",id:384390},{books_count:"68932",name:"Short Stories",id:384406},{books_count:"44358",name:"Spirituality",id:384414},{books_count:"28518",name:"Music",id:384491},{books_count:"26837",name:"War",id:384501}],PopularAuthors:[{name:"J. K. Rowling",id:2546420},{name:"Neil Gaiman",id:390302},{name:"J. R. R. Tolkien",id:2546420},{name:"Charles Dickens",id:388643}],ReadTimes:[{name:"For a flight journey",page_count_range:"Less than 50",id:772852},{name:"For a weekend getaway",page_count_range:"50 to 100",id:772853},{name:"For a week's holiday",page_count_range:"100 to 250",id:772854},{name:"For a month's sabbatical",page_count_range:"More than 250",id:772855}],Emotions:emotions,IntroConstants:{NewsFeed:"<div class='tooltip_header'><div class='larger_font inline_block icon-newspaper site_color'></div><div class='inline_block header_text'>Keep track of what your friends are doing on Oditty.</div></div>",Shelves:"<div class='tooltip_header'><div class='larger_font inline_block icon-bookmark2 yellow_color'></div><div class='inline_block header_text'>Create virtual book shelves.</div></div>",Trending:"<div class='tooltip_header'><div class='larger_font inline_block icon-bars red_color'></div><div class='inline_block header_text'>Check out books related to trending topics in media.</div></div>",Listopia:"<div class='tooltip_header'><div class='larger_font inline_block icon-list purple_color'></div><div class='inline_block header_text'>Check out customised lists of books from different magazines.</div></div>",Friends:"<div class='tooltip_header'><div class='larger_font inline_block icon-users green_color'></div><div class='inline_block header_text'>Explore your friends profile.</div></div>",Share:"<div class='tooltip_header'>Share your book reading memories, insights, feelings and emotions...</div>",Profile:"<div class='tooltip_header'>Edit your profile</div>",RecommendationTab:"<div class='tooltip_header'>Recommendations Tab</div>",MyLibraryTab:"<div class='tooltip_header'>My Library Tab</div>",BooksReadTab:"<div class='tooltip_header'>Books Read Tab</div>",ShelvesTab:"<div class='tooltip_header'>Your personalised recommendations and library of books.</div>",Scroller:"<div class='tooltip_header'>Try these scrollers</div>"},LoginConstants:{EmailNotPresent:"Enter your email address",PasswordNotPresent:"Enter your password",PasswordLengthError:"Minimum password length is 8",ChooseAMoreSecurePassword:"Choose a more secure password",MaximumPasswordLengthError:"Maximum password length is 100",FacebookLoginStatusCheck:"connected",Description:["<b>Connecting information</b> in news and media with books...","Creating <b>virtual shelves</b> of books...","Setting <b>filters</b> on books...","Capturing book reading journeys...","Working on your <b>personalised book recommendations</b>...","Building <b>Listopia</b> of books...","Get set Login..."]},RecommendationUIConstants:{TickerPopupMaxHeight:"54vh",FriendsGridMaxHeight:"54vh",FriendsGridMinHeight:"30vh",NotificationsMinHeight:"30vh",NotificationsMaxHeight:"54vh",BookmarkPanel:"BOOKMARK",BookTab:"BOOK",AuthorTab:"AUTHOR",ReaderTab:"READER",ZeroBooksFound:"ALERT- Reset the filters couldn't find more books.",MarkAsRead:"I HAVE READ",InfluentialBooks:"INFLUENTIAL BOOKS",FetchingData:"Fetching data from your apps on facebook...",FetchingError:"Error in fetching data from the database...",DatabaseConnect:"Connecting to Oditty database...",BooksFound:"Please choose the right book for the title you've read..."},SearchUIConstants:{BookLabel:"Book",AuthorLabel:"Author",ReaderLabel:"User",TypeMore:"Type more characters...",ComingSoon:"Coming soon with exhaustive filters...",NoResultsFound:"No results found...",BookSearch:"BOOK",TextSearch:"TEXT",BookSearchPlaceholder:"Search books...",SearchingBooks:"Searching books...",AuthorSearch:"AUTHOR",AuthorSearchPlaceholder:"Search authors...",AuthorPlaceholder:"Search and add an author to filters...",SearchingAuthors:"Searching authors...",ReaderSearch:"READER",ReaderSearchPlaceholder:"Search readers...",SearchingReaders:"Searching readers...",SearchingGenres:"Searching genres...",SearchingAuthors:"Searching authors...",SearchingUsers:"Searching users...",Year:"YEAR",YearPlaceholder:"Search and add a published year to filters...",List:"LIST",ListPlaceholder:"by list...",Country:"COUNTRY",CountryPlaceholder:"Search and add a country to filters...",Genre:"GENRE",GenrePlaceholder:"Search and add a genre to filters...",Time:"TIME",TimePlaceholder:"Search and add a reading time to filters...",Gender:"GENDER",GenderPlaceholder:"by gender...",MaleGender:"Male",FemaleGender:"Female",DontCareGender:"I don't care",Awards:"AWARDS",AwardsPlaceholder:"by awards...",LevelTwoPlaceHolder:"Select a category",BookSearchLink:"Book",AuthorSearchLink:"Author",ReaderSearchLink:"Reader",SearchPlaceholder:"Add filters or start searching books and authors...",BookByYearLink:"Find books by era",BookByReadingTimeLink:"Find books by reading time",BookByRegionLink:"Find books by region",BookByGenreLink:"Find books by genre",BookListsLink:"Get popular lists of books",BookByAuthorLink:"Find books by author",AuthorByYearLink:"Find authors by era",AuthorByRegionLink:"Find authors by region",AuthorByAwardsLink:"Find authors by awards",AuthorsByGenreLink:"Find authors by genre",AuthorListsLink:"Get popular lists of authors",ReaderByRegionLink:"Find readers by region",ReaderByTasteLink:"Find readers by their taste",ReaderByGenderLink:"Find readers by gender",ReaderListsLink:"Get popular lists of readers",SearchingWebsite:"Searching Oditty...",SearchAll:"ALL",Hash:"#",Plus:"+",AtTheRate:"@",SearchingAuthorsAndReaders:"Searching authors and readers...",SearchingTags:"Searching books categories...",TagSearch:"TAG"},WebsiteUIConstants:{LeftPanelMinWidth:"16%",ServerError:"Something went wrong. Our developers are working on this error.",Share:"Share your book reading journey...",BrowserIncompatible:"Please use latest version of Chrome for now...",Enter:13,Backspace:8,KeyUp:38,KeyDown:40,KeyLeft:37,KeyRight:39,Delete:46,Escape:27,LeftShift:16,RightShift:51,LeftCommand:91,RightCommand:93,StatusPosted:"Shared",CoverPhotoCDN:"http://rd-images.readersdoor.netdna-cdn.com/cp/",GenreAWS:"https://s3-ap-southeast-1.amazonaws.com/rd-genres/"},ColorConstants:{value:["#26c6da","#00acc1","#0097a7","#00838f","#006064"]},ShareOptions:{ReadingStage:[{name:"Planning to read",nested_options:[{name:"Looking to buy",search_book:!0},{name:"Looking to borrow",search_book:!0}]},{name:"Reading",nested_options:[{name:"Feeling",value:emotions}]},{name:"Finished reading",nested_options:[{name:"Feeling",value:emotions}]}]},StatusUIConstants:{EmotionConstants:{icon:"icon-happy",name:"Emotion",value:[{name:"Currently reading",icon:"i-reading",label:"Reading",icon2:"icon-book",value:[{SearchBook:!0}]},{name:"Feeling",icon:"i-feeling",label:"Feeling",value:emotions,icon2:"icon-book"},{name:"Thinking about",icon:"i-thinking",label:"Thinking",icon2:"icon-book",value:[{SearchBook:!0}]},{name:"Smelling pages of",icon:"i-smelling",label:"Smelling",icon2:"icon-book",value:[{SearchBook:!0}]},{name:"Counting pages of",icon:"i-counting",label:"Counting",icon2:"icon-book",value:[{SearchBook:!0}]}]},OwnershipConstants:{icon:"icon-feed",name:"Shout",value:[{name:"Looking to buy",icon:"",value:[{SearchBook:!0}]},{name:"Looking to borrow",icon:"",value:[{SearchBook:!0}]},{name:"Willing to lend",icon:"",value:[{SearchBook:!0}]}]},QuoteConstants:{icon:"icon-quote-right",name:"Quote"}}};angular.forEach(constants,function(a,b){appConstants.constant(b,a)});;homeApp.service("websiteService",["$http","$q","$rootScope","WebsiteUIConstants",function(a,b,c,d){this.get_testimonials=function(c){return _deferred_request("/api/v0/get_testimonials?skip="+c,b,a)},this.extract_embed=function(c){return _deferred_request(c,b,a)},this.add_testimonial=function(c){return _deferred_request("/api/v0/add_testimonial?data="+c,b,a)},this.save_ad=function(c){return _deferred_post_request("/api/v0/save_ad",c,b,a)},this.recover_password=function(c){return _deferred_request("/api/v0/recover_password?"+c,b,a)},this.add_video=function(c,d){return _deferred_request("/api/v0/add_video?id="+c+"&url="+d,b,a)},this.add_videos=function(c){return _deferred_request("/api/v0/add_videos?id="+c,b,a)},this.fb_books_map=function(c){return _deferred_request("/api/v0/fb_books_map?id="+c,b,a)},this.handle_facebook_books=function(c){return _deferred_post_request("/api/v0/fb_books",c,b,a)},this.map_facebook_books=function(c){return _deferred_post_request("/api/v0/map_fb_book",c,b,a)},this.get_user=function(){return _deferred_request("/api/v0/user",b,a)},this.logout=function(){return _deferred_request("/api/v0/logout",b,a)},this.save_user_info=function(c){return _deferred_post_request("/api/v0/save_info",c,b,a)},this.handle_facebook_user=function(c){return _deferred_post_request("/api/v0/fb",c,b,a)},this.handle_facebook_likes=function(c){return _deferred_post_request("/api/v0/fb_likes",c,b,a)},this.handle_google_user=function(c){return _deferred_post_request("/api/v0/google",c,b,a)},this.authenticate=function(c){return _deferred_post_request("/api/v0/authenticate",c,b,a)},this.get_user_details=function(c){return angular.isDefined(c)?_deferred_request("/api/v0/user_details?id="+c,b,a):_deferred_request("/api/v0/user_details",b,a)},this.get_personal_notifications=function(){return _deferred_request("/api/v0/personal_notifications",b,a)},this.set_like_info=function(c){return _deferred_post_request("/api/v0/set_like_info",c,b,a)},this.get_community_videos=function(c){return _deferred_request("/api/v0/get_community_videos?id="+c,b,a)}}]);;app.controller("MainCtrl",["$scope","scroller","$document","$timeout","WebsiteUIConstants","$interval","$mdDialog","$mdSidenav","$cookieStore","$mdToast",function(a,b,c,d,e,f,g,h,i,j){var k;a.scroll_page=function(b){a.nested_page_id=0,a.hide_text=!1,b<=a.data.length-1&&(a.current_page_id=b,a._scroll_page_to(b))},a._scroll_page_to=function(b){a._handle_down_button(b),b=a.data[b],a._scroll_page_to_id(b)},a._scroll_page_to_id=function(a){var c=0,d=2e3;a+="-content";var e=angular.element(document.getElementById(a));b.scrollToElement(e,c,d)},a._handle_down_button=function(b){0==b?a.down_button_style={bottom:"110px"}:b==a.data.length-1?a.down_button_style={display:"none"}:a.down_button_style={bottom:"20px"}},a.search_animate=function(){var b=["H","i","t","c","h","h","i","k","e"];a.text_index<b.length?(a.current_text=a.current_text+b[a.text_index],a.text_index=a.text_index+1):a.typing_active=!1},a.$on("timer-tick",function(){a.search_animate()}),a.scroll_next_state=function(){var b=2==a.current_page_id,c=3==a.current_page_id,d=4==a.current_page_id,e=5==a.current_page_id,f=function(){a.hide_text=!1;var b=a.current_page_id+1;a.scroll_page(b)},g=function(){a.hide_text=!0,a.nested_page_id=1};b?(a.nested_page_id=a.nested_page_id+1,1==a.nested_page_id?(a.nested_page_id=2,a._scroll_page_to_id("Search"),a.hide_text=!0,a.$broadcast("timer-start"),a.search_animated="<span>"+a.current_text+"</span>"):2==a.nested_page_id||3==a.nested_page_id||f()):c?(a.nested_page_id=a.nested_page_id+1,1==a.nested_page_id?(a._scroll_page_to_id("ConnectInner"),a.hide_text=!0):2==a.nested_page_id||3==a.nested_page_id||f()):d?0==a.nested_page_id?(a._scroll_page_to_id("ExploreInner"),g()):(a.nested_page_id=0,f()):e?0==a.nested_page_id?(a._scroll_page_to_id("PersonaliseInner"),g()):(a.nested_page_id=0,f()):f()},a.scroll_previous_state=function(){a.hide_text=!1;var b=a.current_page_id-1;a.scroll_page(b)},a.scroll_on_keypress=function(b){b.keyCode==e.KeyUp?a.scroll_previous_state():b.keyCode==e.KeyDown&&a.scroll_next_state(),b.stopPropagation()},a.bind_mousewheel_scroll=function(b){b.preventDefault();var c=b.wheelDelta,e=function(){c>0?a.current_page_id>0&&a.scroll_previous_state():a.current_page_id<a.data.length&&a.scroll_next_state()};if(a.scroll_active){a.scroll_active=!1,e();var f=d(function(){a.scroll_active=!0},500);a.$on("destroy",function(){d.cancel(f)})}b.stopPropagation()},a.show_signin_options=function(a){h("right").toggle(),a.stopPropagation()},a.left_tab_list=function(a){h("left").toggle(),a.stopPropagation()},a.getToastPosition=function(){return Object.keys(a.toast_position).filter(function(b){return a.toast_position[b]}).join(" ")},a.cancel_redirect=function(){j.hide(),d.cancel(k)};(function(){a.data=["Intro","ReadersDoor","Discover","Connect","Explore","Personalise"];document.getElementsByTagName("video")[0];a.current_page_id=0,a.nested_page_id=0,d(function(){a.show_content=!0},3e3),a.toast_position={bottom:!1,top:!0,left:!1,right:!0},a.down_button_style={bottom:"110px"},a.scroll_active=!0,a.text_index=1,a.current_text=""})()}]);;homeApp.controller("signupController",["$scope","$rootScope","Facebook","$timeout","$cookieStore","LoginConstants","WebsiteUIConstants","$location","$routeParams","websiteService","$mdSidenav",function(a,b,c,d,e,f,g,h,i,j,k){a.processAuth=function(b){b.access_token?a.signedIn=!0:"immediate_failed"==b.error&&(gapi.auth.authorize({client_id:"917672049716-pl6i0qbuen1so84tg2b5vijg7qfjhash.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/plus.login email",immediate:!0},function(a){a.status.signed_in}),a.signedIn=!1)},a.close_signup_options=function(){k("signup").toggle()},a.signInCallback=function(b){a.$apply(function(){a.processAuth(b)})},a.renderSignInButton=function(){gapi.signin.render("signInButton",{callback:a.signInCallback,clientid:"917672049716-pl6i0qbuen1so84tg2b5vijg7qfjhash.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/plus.login https://www.googleapis.com/auth/userinfo.email",cookiepolicy:"single_host_origin"})},a.submit=function(b){var c=b.keyCode==g.Enter;c&&a.authenticate(!0),b.stopPropagation()},a.recover_password=function(){var c=function(c){a.loading_icon=!1,a.user.error_message=c.message,b.user.password=null},d=function(c){a.$apply(function(){a.loading_icon=!1,a.user.error_message=c.message,b.user.password=null})};b.user.email?(a.loading_icon=!0,j.recover_password("email="+b.user.email).then(c,d)):a.user.error_message=f.EmailNotPresent},a.authenticate=function(c){c?a.show_sign_up=!1:a.show_sign_up=!0;var d=b.user.email,g=b.user.password,h=new RegExp("^.{8,}$"),i=new RegExp("^(.)\\1{7,16}$"),k=new RegExp("^.{100,}$"),l={email:d,password:g,old_user:c},n=function(c){b.user=c.user,e.put("user",c.user),a._init_user(),m(),a.info.hide_signin=!0},o=function(c){a.loading_icon=!1,a.user.error_message=c.data.message,b.user.password=null};b.user.email?b.user.password?h.test(b.user.password)||c?i.test(b.user.password)&&!c?a.user.error_message=f.ChooseAMoreSecurePassword:k.test(b.user.password)&&!c?a.user.error_message=f.MaximumPasswordLengthError:(a.loading_icon=!0,j.authenticate(l).then(n,o)):a.user.error_message=f.PasswordLengthError:a.user.error_message=f.PasswordNotPresent:a.user.error_message=f.EmailNotPresent};var l=function(){a.$on("event:google-plus-signin-success",function(b,c){j.handle_google_user(c),a._init_user()}),a.$on("event:google-plus-signin-failure",function(a,b){})};a.intent_login=function(){a.loading_icon=!0,b.user.fb_connect?(b.logged=!0,a.me()):a.login()},a.login=function(){c.login(function(b){b.status==f.FacebookLoginStatusCheck&&a.me()},{scope:"email"})},a.me=function(){deleteCookie("redirect_url"),setCookie("redirect_url",h.$$absUrl),c.api("/me",function(c){angular.isUndefined(b.user)&&(b.user={}),j.handle_facebook_user(c).then(function(c){b.user=angular.extend(b.user,c),a._init_user(),m()}),b.user=angular.extend(b.user,c)})};var m=function(){var a=getCookie("redirect_url");1==b.user.login_count?a="/customise":(!a||a.indexOf("signup")>0)&&(a="/home"),window.location.href=a};a._init_user=function(){b.user.logged=!0,setCookie("logged",!0,31),setCookie("logged",b.user.id,31)},a._is_logged_in=function(){var c=function(){j.get_personal_notifications().then(function(a){b.user.push_notifications=[],angular.forEach(a,function(a){var b=angular.extend({id:a[1]},a[0].data);this.push(b)},b.user.push_notifications)})};j.get_user().then(function(d){d.logged_in&&(b.user.logged=!0,b.user.id=d.id,j.get_user_details().then(function(a){angular.extend(b.user,a)}),a._init_user(),c())})};(function(){l(),b.user={books:{bookmarked:[],read:[]},authors:{bookmarked:[],follow:[]},readers:{follow:[]},logged:!1},b.user.fb_connect=!1,c.getLoginStatus(function(a){a.status===f.FacebookLoginStatusCheck&&(b.user.fb_connect=!0)});var e=0,g=500,h=function(b){a.description=[],a.description.splice(0,0,f.Description[b])};angular.forEach(f.Description,function(){0==e?(h(e),e+=1):d(function(){h(e),e+=1},g),g+=1500})})()}]);